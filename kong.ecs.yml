_format_version: "3.0"
_transform: true

services:
  - name: users-service
    # ECS Service Discovery DNS format: service-name.namespace
    host: users.hiver-dev.local
    port: 3000
    protocol: http
    connect_timeout: 60000
    write_timeout: 60000
    read_timeout: 60000
    retries: 0
    routes:
      - name: users-route
        paths:
          - /users
        methods:
          - GET
          - POST
          - PATCH
          - PUT
          - DELETE
          - OPTIONS
        strip_path: false
      - name: teams-route
        paths:
          - /teams
        methods:
          - GET
          - POST
          - PATCH
          - PUT
          - DELETE
          - OPTIONS
        strip_path: false
      - name: companies-route
        paths:
          - /companies
        methods:
          - GET
          - POST
          - PATCH
          - PUT
          - DELETE
          - OPTIONS
        strip_path: false
      - name: auth-route
        paths:
          - /auth
        methods:
          - GET
          - POST
          - OPTIONS
        strip_path: false
      - name: users-app-health
        paths:
          - /users-app/health
        methods:
          - GET
        strip_path: false
      - name: users-api-docs
        paths:
          - /users-api
        methods:
          - GET
          - OPTIONS
        strip_path: true
  - name: presence-service
    host: presence.hiver-dev.local
    port: 3001
    protocol: http
    connect_timeout: 60000
    write_timeout: 60000
    read_timeout: 60000
    retries: 0
    routes:
      - name: presence-checkin-route
        paths:
          - /checkincheckout
        methods:
          - GET
          - POST
          - OPTIONS
        strip_path: false
      - name: presence-nfc-tags-route
        paths:
          - /nfc-tags
        methods:
          - GET
          - POST
          - PATCH
          - PUT
          - DELETE
          - OPTIONS
        strip_path: false
      - name: presence-user-info-route
        paths:
          - /checkin-user-info
        methods:
          - GET
          - OPTIONS
        strip_path: false
      - name: presence-app-health
        paths:
          - /presence-app/health
        methods:
          - GET
        strip_path: false
      - name: presence-api-docs
        paths:
          - /presence-api
        methods:
          - GET
          - OPTIONS
        strip_path: true

  - name: requests-service
    host: requests.hiver-dev.local
    port: 3002
    protocol: http
    connect_timeout: 60000
    write_timeout: 60000
    read_timeout: 60000
    retries: 0
    routes:
      - name: requests-route
        paths:
          - /requests
        methods:
          - GET
          - POST
          - PATCH
          - PUT
          - DELETE
          - OPTIONS
        strip_path: false
      - name: requests-app-health
        paths:
          - /requests-app/health
        methods:
          - GET
        strip_path: false
      - name: requests-api-docs
        paths:
          - /requests-api
        methods:
          - GET
          - OPTIONS
        strip_path: true

  - name: tasks-service
    host: tasks.hiver-dev.local
    port: 3003
    protocol: http
    connect_timeout: 60000
    write_timeout: 60000
    read_timeout: 60000
    retries: 0
    routes:
      - name: tasks-route
        paths:
          - /tasks
        methods:
          - GET
          - POST
          - PATCH
          - PUT
          - DELETE
          - OPTIONS
        strip_path: false
      - name: tasks-app-health
        paths:
          - /tasks-app/health
        methods:
          - GET
        strip_path: false
      - name: tasks-api-docs
        paths:
          - /tasks-api
        methods:
          - GET
          - OPTIONS
        strip_path: true

  - name: notifications-service
    host: notifications.hiver-dev.local
    port: 3005
    protocol: http
    connect_timeout: 60000
    write_timeout: 60000
    read_timeout: 60000
    retries: 0
    routes:
      - name: notifications-health
        paths:
          - /notifications
        methods:
          - GET
        strip_path: true
      - name: notifications-api-docs
        paths:
          - /notifications-api
        methods:
          - GET
          - OPTIONS
        strip_path: true

plugins:
  - name: cors
    config:
      origins: ["*"]
      methods: [GET, POST, PATCH, PUT, DELETE, OPTIONS]
      headers: [Authorization, Content-Type]
      credentials: false
      max_age: 3600
